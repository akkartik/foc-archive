<html>
<head><meta charset="UTF-8"></head><h2>Archives, <a href="https://futureofcoding.org/community">Future of Coding Community</a>, #thinking-together</h2>
  <table>
  <tr>
    <td style="width:72px; vertical-align:top; padding-bottom:1em">
      <img src="https://secure.gravatar.com/avatar/97d109cd43603e00a23a4c90d9da4c65.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>korede</b>
<span style="margin:2em; color:#606060">2020-06-25 14:15</span><br/>
python’s adding structural pattern matching <a href="https://www.python.org/dev/peps/pep-0622/">https://www.python.org/dev/peps/pep-0622/</a>
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593120090.472800"></a>
      <img src="https://avatars.slack-edge.com/2018-05-22/369438371830_ec35ac5b251f37e26aca_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593120090.472800" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Dan Cook</b>
<span style="margin:2em; color:#606060">2020-06-25 14:21</span><br/>
This is one of several "functional programming" features I've been seeing creep into imperative languages over the last few years. I think over time, the really good features of FP and imperative programming wind up crossing the fence until it's almost everywhere.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593120219.473100"></a>
      <img src="https://secure.gravatar.com/avatar/2266cacc8f3c9964e7bfb1c357bf6873.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593120219.473100" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Chris Maughan</b>
<span style="margin:2em; color:#606060">2020-06-25 14:23</span><br/>
<a href="https://janet-lang.org/docs/peg.html">https://janet-lang.org/docs/peg.html</a>
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593120251.474300"></a>
      <img src="https://secure.gravatar.com/avatar/2266cacc8f3c9964e7bfb1c357bf6873.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593120251.474300" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Chris Maughan</b>
<span style="margin:2em; color:#606060">2020-06-25 14:24</span><br/>
I’m not a language geek, but is this similar to PEG that I spotted in Janet recently?
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593123372.474700"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593123372.474700" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-25 15:16</span><br/>
Heh, I was just looking at PEP 622. First I was excited, then thought it's very messy and confusing. There's a new 'pattern grammar' which doesn't quite look or work like usual Python. Maybe it will make sense to me at some point.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593123446.474900"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593123446.474900" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-25 15:17</span><br/>
It's not exactly like PEG. It's a language feature that lets you match objects against a pattern and <b>also</b> extract some matched parts into variables.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593123683.475100"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593123683.475100" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-25 15:21</span><br/>
So PEGs (and regexes) are matchers for <em>text</em>. This is a built in language syntax to make a matcher for <em>object trees</em>, if that makes any sense.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593152028.477700"></a>
      <img src="https://secure.gravatar.com/avatar/7cefc64f7b1b53513625bf3487ecd16d.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0008-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593152028.477700" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Ionuț G. Stan</b>
<span style="margin:2em; color:#606060">2020-06-25 23:13</span><br/>
<span style="background-color:#ccf">@Shalabh</span> I'm curious, what makes you say "doesn't quite look or work like usual Python"?
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593154751.478000"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593154751.478000" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-25 23:59</span><br/>
Hehe do we really want to get into PEP 622 here? Mainly it's because the meaning of whatever follows <tt>case</tt> is surprising if you know Python. It's not regular Python, it looks regular but is designed to work as a structure matching (and name binding language). Consider:<br/><tt>case 123:</tt> - matches the value 123. so far so good<br/><br/><tt>abc = 123</tt><br/><tt>case abc:</tt> - matches 123? No, it matches <em>any</em> value because <tt>abc</tt> is a name pattern (will capture any value). What if you really wanted to match the value in the variable <tt>abc</tt>? Well now there's a brand new syntax (which only works inside case): <tt>case .abc</tt>.<br/><br/>Then there's the class patterns, which look like calls but actually <b>capture</b> values from an existing structure:<br/><tt>case Point(x, y)</tt> - creates/sets x and y, if the object is a Point.<br/><br/>Anyway the PEP is still being worked on so lets see what it looks like eventually.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593156847.478300"></a>
      <img src="https://secure.gravatar.com/avatar/7cefc64f7b1b53513625bf3487ecd16d.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0008-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593156847.478300" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Ionuț G. Stan</b>
<span style="margin:2em; color:#606060">2020-06-26 00:34</span><br/>
Thanks for going into the details. I don't want to hijack this Slack/thread with programming language minutia, but I'm a PL nerd so I'm always curious to see what new features there are in various languages.<br/><br/>I'm writing Scala for my day job and I've also used Haskell, Standard ML and Erlang for personal projects. They all have pattern matching constructs and pretty much all of them expose the same set of features you're talking about, with slight variations of course. From this point of view, at least, this PEP follows "industry standards".
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593157374.478600"></a>
      <img src="https://avatars.slack-edge.com/2019-02-05/542651515888_326328f75c3f2a08544c_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593157374.478600" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Edward de Jong</b>
<span style="margin:2em; color:#606060">2020-06-26 00:42</span><br/>
This type of complex domain specific language with all of its tricks and traps is probably a mistake. For those rare instances when it would be used, you have now added 50 pages in the reference manual to explain all the subtleties. This type of feature is exactly the kind of thing Guido was constantly refusing to add. Now that he has left his position as BDFL, the complexification committee will take care of ruining Python. That's okay, i designed my Beads language as the evolution of Python by simplification, it can only help me.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593158757.478900"></a>
      <img src="https://secure.gravatar.com/avatar/7cefc64f7b1b53513625bf3487ecd16d.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0008-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593158757.478900" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Ionuț G. Stan</b>
<span style="margin:2em; color:#606060">2020-06-26 01:05</span><br/>
If anything, this feature is in general abused, rather than seldomly used. I quite like it to be honest, but I find it more useful in a language with static typing.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593159488.479100"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593159488.479100" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-26 01:18</span><br/>
Strangely, Guido is one of the PEP authors :smile: Also there is resistance to the PEP from some core Python folk, so lets see where this goes.<br/><br/>I like the idea of pattern matching too. Having it from the start in a language means other features were designed with it in mind. In Python it is being added later so it's going to be more complex to make it seem to fit. Consider the <tt>except E as e</tt> syntax - it's already kind of a pattern match using just isinstance. Would we not want matching to work identically in that syntax as well? IIRC you can have destructuring assignment in Erlang and put constants on the left, roughly <tt>"red", a = f()</tt> - this only matches and binds iff f() returns "red" as the first item in a pair. There's no such thing in Python, but you can have only free variables on the left that always get bound. Should that also work now, given the unpacking pattern can use <tt>case ["red", a]</tt> ?
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593174608.479600"></a>
      <img src="https://avatars.slack-edge.com/2021-03-12/1859691333940_e169f54bbaf8b9b36b12_72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593174608.479600" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Konrad Hinsen</b>
<span style="margin:2em; color:#606060">2020-06-26 05:30</span><br/>
My first impression is much like <span style="background-color:#ccf">@Shalabh</span>'s: this is going to add a lot of complexity to Python, and is likely to become a nightmare for Python teachers. To add a criticism to <span style="background-color:#ccf">@Shalabh</span>'s list: <tt>Point(x, y)</tt> not only looks like a constructor but isn't, it also interprets arguments in a different way from a constructor. Sure, one would expect Python programmers to ensure that a class' <tt>__init__</tt> and <tt>__match__</tt> are semantically compatible, but I bet we will see many classes whose <tt>__init__</tt> allows more variations than <tt>__match__</tt> . And I also bet that people will try to use <tt>class(**args)</tt> as a pattern and expect <tt>class</tt> to be bound to the class object.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593192337.491400"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593192337.491400" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-26 10:25</span><br/>
I think a fundamental limitation is also you can only match over a key/value like structure. E.g. you can't match <tt>case Regex('a.*b')</tt> - the inner pattern is not sent to the class, but the class is supposed to return a 'static data field like' structure. So this also will cause problems if you have a few expensive computed properties - are you know supposed to generate and return all of them? What if the caller is only matching one?
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593195952.492100"></a>
      <img src="https://avatars.slack-edge.com/2021-03-12/1859691333940_e169f54bbaf8b9b36b12_72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593195952.492100" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Konrad Hinsen</b>
<span style="margin:2em; color:#606060">2020-06-26 11:25</span><br/>
BTW, this discussion made me think of <a href="https://dl.acm.org/doi/10.1145/1639949.1640133">this paper</a> which basically says that destructuring or pattern-matching objects makes no sense at all. TL;DR: Objects expose only their behavior (via methods), but not their internal data structures.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593201054.492300"></a>
      <img src="https://secure.gravatar.com/avatar/7cefc64f7b1b53513625bf3487ecd16d.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0008-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593201054.492300" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Ionuț G. Stan</b>
<span style="margin:2em; color:#606060">2020-06-26 12:50</span><br/>
<span style="background-color:#ccf">@Shalabh</span> for your regex example, it might be possible to do something like:<br/><br/><pre style="white-space:pre-wrap">pattern = Regex('a.*b')<br/>match 'aaaab':<br/>    case pattern(matched, capturingGroup1, etc): pass</pre><br/>Regarding your other point, about expensive computations, the PEP says this:<br/><br/>&gt; There is no requirement that the attributes on the proxy object be the same type or value as the attributes of the original object; one envisioned use case is for expensive-to-compute properties to be computed lazily on the proxy object via property getters.<br/>Also, your concerns about pattern matching for exceptions and assignments are well founded, but it seems to me that they can add these capabilities later.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593201391.492500"></a>
      <img src="https://secure.gravatar.com/avatar/7cefc64f7b1b53513625bf3487ecd16d.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0008-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593201391.492500" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Ionuț G. Stan</b>
<span style="margin:2em; color:#606060">2020-06-26 12:56</span><br/>
<span style="background-color:#ccf">@Konrad Hinsen</span> that's a good paper, but pattern matching does not preclude data abstraction, just as using lists and dictionaries does not preclude it. At some point we have to inspect data and patttern matching helps there. Without this, we'd have to ban <tt>return</tt> or <tt>yield</tt> and write our programs in a completely continuation-passing style, which would be quite hard to understand.<br/><br/>I feel that once you'll be able to play with it, you'll like it more, unless you've already used pattern matching in some other language and decided it was a bad idea there.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593205285.493000"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593205285.493000" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-26 14:01</span><br/>
<span style="background-color:#ccf">@Ionuț G. Stan</span> that seems quite a roundabout way to do regexes, consider if you had multiple cases, you wouldn't be able to write literal regexes inline and have to alias them via new variable names. The PEP also says <tt>__match__</tt>  should be a class or static method, so we'll be creating one class per regex.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593205414.493300"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593205414.493300" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-26 14:03</span><br/>
May main issue though is the seeming arbitrary mixing of 'capture variables' (lvalues) and variables as references. E.g. <tt>a = f()</tt> is clear and <tt>a.b = f()</tt> kinda follows. But <tt>case a</tt> is totally different from <tt>case a.b</tt> - in the latter case it's a reference, the the former case <tt>a</tt> is a name to be bound.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593205749.493500"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593205749.493500" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-26 14:09</span><br/>
Honestly if all lvalues were tagged or separated, this would be much more acceptable to me. e.g. <tt>case Point as x,y</tt> or <tt>case Point(?x, ?y)</tt>
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593205893.493700"></a>
      <img src="https://secure.gravatar.com/avatar/7cefc64f7b1b53513625bf3487ecd16d.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0008-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593205893.493700" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Ionuț G. Stan</b>
<span style="margin:2em; color:#606060">2020-06-26 14:11</span><br/>
I guess you can tag the other case, although it's not enforced: <tt>case .a.b</tt> would work instead of <tt>case a.b</tt>. And I get your point, but on the other hand, the main purpose of pattern matching is to introduce new bindings, so the main use case should introduce as little syntax as possible, I think.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593205978.493900"></a>
      <img src="https://secure.gravatar.com/avatar/7cefc64f7b1b53513625bf3487ecd16d.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0008-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593205978.493900" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Ionuț G. Stan</b>
<span style="margin:2em; color:#606060">2020-06-26 14:12</span><br/>
Also, regarding regexes. I haven't seen any language that supports both passing arguments and binding values in a pattern. That would be interesting.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593208721.494500"></a>
      <img src="https://avatars.slack-edge.com/2019-03-21/584465935395_b7c63cc07373326ec6ea_72.jpg" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593208721.494500" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>Shalabh</b>
<span style="margin:2em; color:#606060">2020-06-26 14:58</span><br/>
I guess you could tag the other case.<br/><br/>I also think these are warts: in places where both <tt>x</tt> and <tt>x()</tt> are valid, the <tt>x</tt> part means the same exact thing. But here one is a new name and one is a reference. What if I wanted to match a specific point at a known x,y? <tt>case Point(x, y)</tt> wont work, but I feel it should work, given I can do <tt>case "hello"</tt> and have the value match. Literals and predefined constants get special features here.
    </td>
  </tr>
  <tr>
    <td style="vertical-align:top; padding-bottom:1em">
      <a name="1593282993.011600"></a>
      <img src="https://secure.gravatar.com/avatar/97d109cd43603e00a23a4c90d9da4c65.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0026-72.png" style="float:left"/>
      <a href="../thinking-together/1593119706.472200.html#1593282993.011600" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>korede</b>
<span style="margin:2em; color:#606060">2020-06-27 11:36</span><br/>
enlightening thread
    </td>
  </tr>
  </table>
<hr>
<a href="https://akkartik.name/foc-archive.zip">download this site</a> (~25MB)<br/>
<a href="https://github.com/akkartik/foc-archive">Git repo</a>
</html>
