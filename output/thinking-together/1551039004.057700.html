<html>
<head><meta charset="UTF-8"></head><h2>Archives, <a href="https://futureofcoding.org/community">Future of Coding Community</a>, #thinking-together</h2>
  <table>
  <tr>
    <td style="width:72px; vertical-align:top; padding-bottom:1em">
      <img src="https://secure.gravatar.com/avatar/e4a9957508aa1bdb16018793cfc1bb40.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0020-72.png" style="float:left"/>
      <a href="../thinking-together/1551039004.057700.html" style="color:#aaa">#</a>
    </td>
    <td style="vertical-align:top; padding-bottom:1em; padding-left:1em">
<b>David Piepgrass</b>
<span style="margin:2em; color:#606060">2019-02-24 12:10</span><br/>
<span style="background-color:#ccf">@Will Crichton</span> "How does your particular decomposition of the compiler compare to other approaches like Roslyn?" I started Enhanced C# back when Roslyn was "shared source" - you could see the code but not contribute. Roslyn inspired me - I took the "red and green tree" idea (later discarding the red tree as green trees are usually enough), and like Roslyn, my Loyc Syntax library has a universal Token format which is a tuple of (token type, start, end, value reference).<br/><br/>Unlike Roslyn,<br/><br/>• I've only tackled the syntax side of things in code (LLLPG and LeMP are preprocessors, not full compilers) while Roslyn includes full compilers. (Rest assured, I want to go far beyond syntax, but taking the time to get things right is more important.)<br/>• I created a common interface, IParsingService, supported by all three languages (EC#, LESv2, LESv3), which decomposes parsing into lexing and parsing stages. (Roslyn probably has something similar, but it's probably less generalized.)<br/>• Roslyn encodes detailed information down to the level of each character in a source file, i.e. it preserves the "parse tree", whereas my design only keeps the "abstract" syntax tree. It can recreate a semantically identical program from a Loyc tree, but cannot actually reproduce the original code.<br/>• I wrote a universal algorithm for associating comments and line breaks with syntax subtrees. The EC# and LES parsers are unaware of comments; after parsing they simply invoke the algorithm to merge the previously "discarded" comments into the final syntax tree.<br/>• Roslyn has far more manpower and so can afford to more specialization. I use the universal token type <em>directly</em> in my three parsers instead of specializing. And I built everything out of Loyc trees rather than having specialized per-language trees. (This choice is useful and convenient in some ways and suboptimal in other ways; in future languages, I would introduce Loyc-tree wrappers or specialized syntax trees that implement ILNode).<br/>• Roslyn is designed specifically for .NET, whereas I chose .NET because it seemed to me like the least-bad choice available (and probably still is.) So much as I'm invested in .NET, I want ports to other languages, I just don't really have time to do them.<br/>• (Added) Enhanced C# is a dramatically different design than C# itself. While it supports the same syntax (except C# 7 due to factors such as a lack of time), it also supports a bunch of additional syntax. Due to these design (and non-design) differences, Roslyn's C# parser is over 10,000 lines, but mine is about 2,000 lines of code.<br/>• (Added) Roslyn is long-winded - A <tt>SimpleMemberAccessExpression</tt> doesn't seem so simple when you give it a name like that! Loyc relies on... what do you call it when your code/data looks like what it represents? I mean, not only is the addition operator called <tt>'+</tt>, but its native textual representation is like <tt>x + y</tt>. I shake my head every time somebody creates a system that doesn't work somewhat like this (admittedly <tt>Loyc.Syntax.CodeSymbols</tt> defines an English name for each operator, due to limitations of C#.) By contrast, Roslyn defines <tt>BinaryExpressionSyntax</tt> nodes where <tt>node.IsKind(SyntaxKind.PlusToken)</tt>is true, or something like that.<br/>• (Added) C# and VB are statement-based, whereas EC# is expression-based, and Loyc trees don't distinguish expressions from statements.<br/><br/>In summary, Roslyn has much broader capabilities, as you'd expect a big team can do, but it shares less code between its compilers... and is long-winded.
    </td>
  </tr>
  </table>
<hr>
<a href="https://akkartik.name/foc-archive.zip">download this site</a> (~25MB)<br/>
<a href="https://github.com/akkartik/foc-archive">Git repo</a>
</html>
